# Skill Generation Templates

> Templates for generating valid jaan.to skill files.

---

## SKILL.md Template

```markdown
---
name: {skill_name}
description: |
  {description_line_1}
  Auto-triggers on: {trigger_phrases}.
  Maps to: {logical_name}
allowed-tools: {tool_list}
argument-hint: {argument_format}
---

# {logical_name}

> {one_line_purpose}

## Context Files

Read these before execution:
- `$JAAN_LEARN_DIR/{skill_name}.learn.md` - Past lessons (loaded in Pre-Execution)
{additional_context_files}

## Input

**{input_name}**: $ARGUMENTS

{input_instructions}

---

# PHASE 1: Analysis (Read-Only)

## Pre-Execution: Apply Past Lessons

**MANDATORY FIRST ACTION** — Before any other step, use the Read tool to read:
`$JAAN_LEARN_DIR/{skill_name}.learn.md`

If the file exists, apply its lessons throughout this execution:
- Add questions from "Better Questions" to Step 1
- Note edge cases to check from "Edge Cases"
- Follow workflow improvements from "Workflow"
- Avoid mistakes listed in "Common Mistakes"

## Step 1: Gather Information

{questions_to_ask}

## Step 2: Plan Structure

{structure_planning}

---

# HARD STOP - Human Review Gate

{preview_description}

> "Ready to proceed? [y/n]"

**Do NOT proceed to Phase 2 without explicit approval.**

---

# PHASE 2: Generation (Write Phase)

## Step 3: Generate Content

{generation_instructions}

## Step 4: Quality Check

Before preview, verify:
{quality_checks}

If any check fails, revise before preview.

## Step 5: Generate Slug

1. Generate slug from input: lowercase-kebab-case, max 50 chars
2. Preview slug to user

## Step 5.5: Generate ID and Folder Structure

1. Source ID generator:
\`\`\`bash
source "${CLAUDE_PLUGIN_ROOT}/scripts/lib/id-generator.sh"
\`\`\`

2. Generate paths:
\`\`\`bash
SUBDOMAIN_DIR="$JAAN_OUTPUTS_DIR/{role}/{subdomain}"
mkdir -p "$SUBDOMAIN_DIR"

NEXT_ID=$(generate_next_id "$SUBDOMAIN_DIR")
OUTPUT_FOLDER="${SUBDOMAIN_DIR}/${NEXT_ID}-${slug}"
MAIN_FILE="${OUTPUT_FOLDER}/${NEXT_ID}-{report-type}-${slug}.md"
\`\`\`

3. Preview:
> **Output Configuration**
> - ID: {NEXT_ID}
> - Folder: jaan-to/outputs/{role}/{subdomain}/{NEXT_ID}-{slug}/
> - Main file: {NEXT_ID}-{report-type}-{slug}.md

## Step 6: Preview & Approval

Show complete output and ask:
> "Write to {output path}? [y/n]"

## Step 7: Write Output

If approved:
1. Create folder:
\`\`\`bash
mkdir -p "$OUTPUT_FOLDER"
\`\`\`

2. Write main file:
\`\`\`bash
cat > "$MAIN_FILE" <<'EOF'
{output content with Executive Summary section}
EOF
\`\`\`

3. Update index:
\`\`\`bash
source "${CLAUDE_PLUGIN_ROOT}/scripts/lib/index-updater.sh"
add_to_index \
  "$SUBDOMAIN_DIR/README.md" \
  "$NEXT_ID" \
  "${NEXT_ID}-${slug}" \
  "{Title}" \
  "{Executive summary}"
\`\`\`

4. Confirm:
> ✓ Output written to: jaan-to/outputs/{role}/{subdomain}/{NEXT_ID}-{slug}/{NEXT_ID}-{report-type}-{slug}.md
> ✓ Index updated

## Step 8: Capture Feedback

> "Any feedback? [y/n]"

If yes:
> "[1] Fix now  [2] Learn for future  [3] Both"

- **Option 1**: Update output, re-preview, re-write
- **Option 2**: Run `/learn-add {skill_name} "{feedback}"`
- **Option 3**: Do both

---

## Definition of Done

{definition_of_done}
```

---

## LEARN.md Starter Template

```markdown
# Lessons: {skill_name}

> Last updated: {date}

Accumulated lessons from past executions. Read this before executing to avoid past mistakes and apply learned improvements.

---

## Better Questions

Questions to ask during information gathering:

{initial_questions_from_research}

## Edge Cases

Special cases to check and handle:

{edge_cases_from_research}

## Workflow

Process improvements:

{workflow_from_research}

## Common Mistakes

Things to avoid:

{mistakes_from_research}
```

---

## template.md Structure (for skill outputs)

```markdown
# {{title}}

> Generated by jaan.to | {{date}}

---

## Executive Summary

{1-2 sentence high-level summary of the problem, solution, or findings}

---

## {section_1_name}

{section_1_content}

---

## {section_2_name}

{section_2_content}

---

## {section_n_name}

{section_n_content}

---

## Metadata

| Field | Value |
|-------|-------|
| Generated | {{date}} |
| Skill | {{skill_name}} |
| Status | Draft |
| Version | 3.0 |
```

---

## Tool Permission Patterns Reference (v3.0.0)

| Need | Pattern |
|------|---------|
| Read any file | `Read` |
| Find files | `Glob` |
| Search content | `Grep` |
| Web research | `WebSearch`, `Task` |
| Write outputs | `Write($JAAN_OUTPUTS_DIR/{role}/**)` |
| Write to docs | `Write(docs/**)` |
| Write to skills | `Write(skills/**)` |
| Edit templates | `Edit($JAAN_TEMPLATES_DIR/**)` |
| Read context | `Read($JAAN_CONTEXT_DIR/**)` |
| Write learning | `Write($JAAN_LEARN_DIR/**)` |
| Git stage | `Bash(git add:*)` |
| Git commit | `Bash(git commit:*)` |
| Git push | `Bash(git push:*)` |
| Create PR | `Bash(gh pr create:*)` |

**v3.0.0 Best Practices**:
- ✓ Always use `$JAAN_*` environment variables
- ✗ Never hardcode `jaan-to/` paths (not customizable)

---

## Template Variables Reference (v3.0.0)

Use these in template.md files for dynamic content:

### Field Variables
- `{{title}}` - Document title
- `{{date}}` - Current date
- `{{author}}` - Author name
- `{{problem}}`, `{{solution}}`, etc. - Custom fields from context

### Environment Variables
- `{{env:JAAN_OUTPUTS_DIR}}` - Output directory path
- `{{env:JAAN_TEMPLATES_DIR}}` - Templates directory path
- `{{env:CUSTOM_VAR}}` - Any shell environment variable

### Configuration Variables
- `{{config:paths_templates}}` - From settings.yaml
- `{{config:custom_field}}` - Any config key from jaan-to/config/settings.yaml

### Section Imports
Import markdown sections from context files:
- `{{import:$JAAN_CONTEXT_DIR/tech.md#current-stack}}` - Import tech stack
- `{{import:$JAAN_CONTEXT_DIR/tech.md#constraints}}` - Import constraints

**Standard tech.md Anchors**:
- `#current-stack` - Languages, frameworks, databases
- `#frameworks` - Framework-specific details
- `#constraints` - Technical constraints and requirements
- `#versioning` - API versioning, deprecation policies
- `#patterns` - Common patterns (auth, errors, data access)
- `#tech-debt` - Known technical debt items

**Example**:
```markdown
# {{title}}

## Technical Context
**Stack**: {{import:$JAAN_CONTEXT_DIR/tech.md#current-stack}}

**Constraints**:
{{import:$JAAN_CONTEXT_DIR/tech.md#constraints}}

## Output Path
Generated at: {{env:JAAN_OUTPUTS_DIR}}/{{role}}/{{domain}}/
```

---

## Placeholder Reference

| Placeholder | Source |
|-------------|--------|
| `{skill_name}` | Step 1: role-domain-action |
| `{logical_name}` | Step 1: role:domain-action |
| `{description_line_1}` | Step 3: purpose |
| `{trigger_phrases}` | Step 3: triggers |
| `{tool_list}` | Step 5: based on needs |
| `{argument_format}` | Step 4: input format |
| `{one_line_purpose}` | Step 3: short version |
| `{questions_to_ask}` | Step 5: questions list |
| `{quality_checks}` | Step 5: checklist |
| `{definition_of_done}` | Step 5: done criteria |
| `{date}` | Current date YYYY-MM-DD |
| `{role}` | Step 1: role prefix |
| `{domain}` | Step 1: domain |
| `{action}` | Step 1: action verb |
