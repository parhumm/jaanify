# Jaanify Infrastructure — Setup & Deployment

## Quick Start (Local Development)

```bash
# 1. Copy environment file
cp jaan-to/outputs/devops/infra-scaffold/02-jaanify-launch/config/.env.example .env

# 2. Start databases
docker compose -f docker/docker-compose.yml up postgres redis -d

# 3. Install dependencies
pnpm install

# 4. Generate Prisma client and run migrations
pnpm --filter jaanify-api exec prisma generate
pnpm --filter jaanify-api exec prisma migrate dev

# 5. Start development servers
pnpm dev
```

API: http://localhost:4000/v1/health
Web: http://localhost:3000

## Docker Development (Full Stack)

```bash
# Start everything
docker compose -f docker/docker-compose.yml --profile full up

# Backend only (API + databases)
docker compose -f docker/docker-compose.yml --profile backend up
```

## CI/CD Setup

### 1. Copy workflows to .github/workflows/

```bash
cp jaan-to/outputs/devops/infra-scaffold/02-jaanify-launch/ci/*.yml .github/workflows/
```

### 2. Set GitHub repository secrets

```bash
gh secret set DATABASE_URL
gh secret set RAILWAY_TOKEN
gh secret set VERCEL_TOKEN
gh secret set VERCEL_ORG_ID
gh secret set VERCEL_PROJECT_ID
```

### 3. Set GitHub repository variables (for health monitoring)

```bash
gh variable set API_URL --body "https://your-api-url.railway.app"
gh variable set WEB_URL --body "https://your-web-url.vercel.app"
```

## Production Deployment

### Railway (API)

1. Link project: `railway link`
2. Deploy: `railway up --service api`
3. Set environment variables in Railway dashboard
4. Verify health: `curl https://your-api.railway.app/v1/health`

### Vercel (Web)

1. Link project: `vercel link`
2. Deploy: `vercel deploy --prod`
3. Set NEXT_PUBLIC_API_URL in Vercel dashboard
4. Verify: `curl https://your-web.vercel.app`

## Important Notes

- **Next.js standalone**: Ensure `output: 'standalone'` is set in `apps/web/next.config.ts` for Docker builds
- **pnpm version**: CI reads from `packageManager` field in root `package.json` — do not set explicit version in workflows
- **Secrets**: Never commit `.env` files — use `.env.example` as template

---

> Generated by jaan-to:devops-infra-scaffold | v6.3.0 | Cycle 11
