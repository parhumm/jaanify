<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jaanify Task Input — Preview</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet">
  <style>
    /* ═══════════════════════════════════════════
       JAANIFY DESIGN TOKENS
       Same tokens as dashboard for consistency
       ═══════════════════════════════════════════ */
    :root {
      --color-bg: #FAF8F5;
      --color-surface: #FFFFFF;
      --color-surface-raised: #F5F2EE;
      --color-primary: #6B8F71;
      --color-primary-light: #8FB596;
      --color-primary-subtle: #E8F0E9;
      --color-accent: #C4836A;
      --color-accent-light: #F0DDD5;
      --color-text: #3D4550;
      --color-text-secondary: #6B7280;
      --color-text-muted: #9CA3AF;
      --color-border: #E5E1DC;
      --color-success: #6B8F71;
      --color-warning: #D4A843;

      --font-family: 'DM Sans', system-ui, -apple-system, sans-serif;
      --font-size-xs: clamp(0.7rem, 0.65rem + 0.25vw, 0.75rem);
      --font-size-sm: clamp(0.8rem, 0.75rem + 0.25vw, 0.875rem);
      --font-size-base: clamp(0.9rem, 0.85rem + 0.25vw, 1rem);
      --font-size-lg: clamp(1.05rem, 1rem + 0.25vw, 1.125rem);
      --font-size-xl: clamp(1.25rem, 1.15rem + 0.5vw, 1.5rem);
      --font-size-2xl: clamp(1.5rem, 1.35rem + 0.75vw, 1.875rem);

      --space-xs: 0.25rem;
      --space-sm: 0.5rem;
      --space-md: 0.75rem;
      --space-lg: 1rem;
      --space-xl: 1.5rem;
      --space-2xl: 2rem;

      --radius-sm: 0.5rem;
      --radius-md: 0.75rem;
      --radius-lg: 1rem;
      --radius-xl: 1.25rem;

      --shadow-sm: 0 1px 2px rgba(61, 69, 80, 0.04);
      --shadow-md: 0 2px 8px rgba(61, 69, 80, 0.06);
      --shadow-lg: 0 4px 16px rgba(61, 69, 80, 0.08);
      --shadow-focus: 0 0 0 3px rgba(107, 143, 113, 0.3);

      --transition-fast: 150ms ease-out;
      --transition-normal: 200ms ease-out;
      --transition-slow: 300ms ease-out;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --color-bg: #1A1D21;
        --color-surface: #242830;
        --color-surface-raised: #2D323A;
        --color-primary: #8FB596;
        --color-primary-light: #A8C9AE;
        --color-primary-subtle: #2A3B2D;
        --color-accent: #D4996A;
        --color-accent-light: #3D2E24;
        --color-text: #E8E6E3;
        --color-text-secondary: #9CA3AF;
        --color-text-muted: #6B7280;
        --color-border: #374151;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* ═══════════════════════════════════════════
       BASE
       ═══════════════════════════════════════════ */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      line-height: 1.5;
      color: var(--color-text);
      background: var(--color-bg);
      -webkit-font-smoothing: antialiased;
    }

    .task-input-page {
      max-width: 480px;
      margin: 0 auto;
      padding: var(--space-lg);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ═══════════════════════════════════════════
       HEADER — Minimal back nav
       ═══════════════════════════════════════════ */
    .input-header {
      display: flex;
      align-items: center;
      padding: var(--space-md) 0 var(--space-xl);
    }

    .input-header__back {
      background: none;
      border: none;
      color: var(--color-text-secondary);
      cursor: pointer;
      padding: var(--space-sm);
      margin-left: -0.5rem;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      transition: color var(--transition-fast);
    }

    .input-header__back:hover { color: var(--color-primary); }
    .input-header__back:focus-visible { box-shadow: var(--shadow-focus); outline: none; }

    .input-header__title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      margin-left: var(--space-sm);
    }

    /* ═══════════════════════════════════════════
       INPUT AREA — The main text field
       ═══════════════════════════════════════════ */
    .input-area {
      position: relative;
      margin-bottom: var(--space-xl);
    }

    .input-area__field {
      width: 100%;
      font-family: var(--font-family);
      font-size: var(--font-size-xl);
      font-weight: 400;
      color: var(--color-text);
      background: transparent;
      border: none;
      border-bottom: 2px solid var(--color-border);
      padding: var(--space-md) 0;
      resize: none;
      outline: none;
      transition: border-color var(--transition-normal);
      line-height: 1.4;
      min-height: 3.5rem;
      overflow: hidden;
    }

    .input-area__field::placeholder {
      color: var(--color-text-muted);
      font-weight: 300;
    }

    .input-area__field:focus {
      border-color: var(--color-primary);
    }

    .input-area__hint {
      font-size: var(--font-size-xs);
      color: var(--color-text-muted);
      margin-top: var(--space-sm);
      transition: opacity var(--transition-normal);
    }

    .input-area__hint--hidden { opacity: 0; }

    /* ═══════════════════════════════════════════
       PARSING INDICATOR — Shimmer while AI works
       ═══════════════════════════════════════════ */
    .parsing-indicator {
      display: none;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-sm) 0;
      font-size: var(--font-size-xs);
      color: var(--color-primary);
    }

    .parsing-indicator--active { display: flex; }

    .parsing-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--color-primary);
      animation: pulse-dot 1.2s ease-in-out infinite;
    }

    .parsing-dot:nth-child(2) { animation-delay: 0.2s; }
    .parsing-dot:nth-child(3) { animation-delay: 0.4s; }

    @keyframes pulse-dot {
      0%, 80%, 100% { opacity: 0.3; transform: scale(0.8); }
      40% { opacity: 1; transform: scale(1); }
    }

    /* ═══════════════════════════════════════════
       PARSED RESULT — Enriched task preview
       ═══════════════════════════════════════════ */
    .parsed-result {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: var(--space-xl);
      box-shadow: var(--shadow-md);
      opacity: 0;
      transform: translateY(8px);
      transition: opacity var(--transition-slow), transform var(--transition-slow);
    }

    .parsed-result--visible {
      opacity: 1;
      transform: translateY(0);
    }

    .parsed-result__label {
      font-size: var(--font-size-xs);
      color: var(--color-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--space-md);
    }

    .parsed-result__title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      color: var(--color-text);
      margin-bottom: var(--space-lg);
    }

    /* ─── Extracted metadata chips ─── */
    .parsed-fields {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .parsed-field {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }

    .parsed-field__icon {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .parsed-field__icon--deadline { background: var(--color-accent-light); color: var(--color-accent); }
    .parsed-field__icon--category { background: var(--color-primary-subtle); color: var(--color-primary); }
    .parsed-field__icon--priority { background: #FEF3C7; color: var(--color-warning); }
    .parsed-field__icon--subtask { background: var(--color-surface-raised); color: var(--color-text-secondary); }

    .parsed-field__icon svg { width: 16px; height: 16px; }

    .parsed-field__info { flex: 1; min-width: 0; }

    .parsed-field__key {
      font-size: var(--font-size-xs);
      color: var(--color-text-muted);
    }

    .parsed-field__value {
      font-size: var(--font-size-sm);
      font-weight: 500;
      color: var(--color-text);
    }

    .parsed-field__edit {
      background: none;
      border: none;
      color: var(--color-text-muted);
      cursor: pointer;
      padding: var(--space-xs);
      border-radius: 4px;
      transition: color var(--transition-fast);
      flex-shrink: 0;
    }

    .parsed-field__edit:hover { color: var(--color-primary); }
    .parsed-field__edit:focus-visible { box-shadow: var(--shadow-focus); outline: none; }
    .parsed-field__edit svg { width: 14px; height: 14px; }

    /* ─── Parsing reasoning ─── */
    .parsing-reasoning {
      margin-top: var(--space-lg);
      padding-top: var(--space-lg);
      border-top: 1px solid var(--color-border);
      display: flex;
      align-items: flex-start;
      gap: var(--space-sm);
      font-size: var(--font-size-xs);
      color: var(--color-text-secondary);
    }

    .parsing-reasoning__icon {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      color: var(--color-primary);
      margin-top: 1px;
    }

    .parsing-reasoning__text {
      line-height: 1.5;
    }

    .parsing-reasoning__keyword {
      background: var(--color-primary-subtle);
      color: var(--color-primary);
      padding: 1px 4px;
      border-radius: 3px;
      font-weight: 500;
    }

    /* ═══════════════════════════════════════════
       ACTIONS — Save / Cancel
       ═══════════════════════════════════════════ */
    .actions {
      display: flex;
      gap: var(--space-md);
      margin-top: var(--space-xl);
      opacity: 0;
      transform: translateY(8px);
      transition: opacity var(--transition-slow), transform var(--transition-slow);
    }

    .actions--visible {
      opacity: 1;
      transform: translateY(0);
    }

    .btn {
      flex: 1;
      padding: var(--space-md) var(--space-lg);
      border-radius: var(--radius-md);
      font-family: var(--font-family);
      font-size: var(--font-size-base);
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-fast);
      text-align: center;
      border: none;
    }

    .btn:focus-visible { box-shadow: var(--shadow-focus); outline: none; }

    .btn--primary {
      background: var(--color-primary);
      color: white;
    }

    .btn--primary:hover {
      background: var(--color-primary-light);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn--primary:active { transform: translateY(0); }

    .btn--secondary {
      background: transparent;
      color: var(--color-text-secondary);
      border: 1px solid var(--color-border);
    }

    .btn--secondary:hover {
      border-color: var(--color-text-secondary);
      color: var(--color-text);
    }

    /* ═══════════════════════════════════════════
       VOICE TOGGLE — Inline mic button
       ═══════════════════════════════════════════ */
    .input-area__voice {
      position: absolute;
      right: 0;
      bottom: calc(var(--space-md) + 2px + var(--space-sm) + 1rem);
      width: 36px;
      height: 36px;
      border-radius: var(--radius-sm);
      background: var(--color-surface-raised);
      border: 1px solid var(--color-border);
      color: var(--color-text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .input-area__voice:hover {
      background: var(--color-primary-subtle);
      color: var(--color-primary);
      border-color: var(--color-primary-light);
    }

    .input-area__voice:focus-visible { box-shadow: var(--shadow-focus); outline: none; }

    .input-area__voice--active {
      background: var(--color-primary);
      color: white;
      border-color: var(--color-primary);
      animation: voice-pulse 2s ease-in-out infinite;
    }

    @keyframes voice-pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(107, 143, 113, 0.3); }
      50% { box-shadow: 0 0 0 6px rgba(107, 143, 113, 0); }
    }

    .input-area__voice svg { width: 18px; height: 18px; }

    /* ═══════════════════════════════════════════
       SUGGESTIONS — Quick task types
       ═══════════════════════════════════════════ */
    .suggestions {
      display: flex;
      gap: var(--space-sm);
      flex-wrap: wrap;
      margin-bottom: var(--space-xl);
    }

    .suggestion-chip {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: 20px;
      padding: var(--space-xs) var(--space-md);
      font-family: var(--font-family);
      font-size: var(--font-size-xs);
      color: var(--color-text-secondary);
      cursor: pointer;
      transition: all var(--transition-fast);
      white-space: nowrap;
    }

    .suggestion-chip:hover {
      background: var(--color-primary-subtle);
      color: var(--color-primary);
      border-color: var(--color-primary-light);
    }

    .suggestion-chip:focus-visible { box-shadow: var(--shadow-focus); outline: none; }

    /* ═══════════════════════════════════════════
       RESPONSIVE
       ═══════════════════════════════════════════ */
    @media (min-width: 768px) {
      .task-input-page {
        max-width: 560px;
        padding: var(--space-2xl);
      }
    }

    @media (min-width: 1024px) {
      .task-input-page {
        max-width: 640px;
        padding-top: 4rem;
      }
    }

    .sr-only {
      position: absolute; width: 1px; height: 1px; padding: 0;
      margin: -1px; overflow: hidden; clip: rect(0,0,0,0);
      white-space: nowrap; border-width: 0;
    }
  </style>
</head>
<body>
  <main class="task-input-page" role="main">
    <!-- Header -->
    <header class="input-header">
      <button class="input-header__back" aria-label="Go back to dashboard">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 4l-6 6 6 6"/>
        </svg>
      </button>
      <h1 class="input-header__title">New Task</h1>
    </header>

    <!-- Suggestion chips -->
    <div class="suggestions" role="list" aria-label="Quick suggestions">
      <button class="suggestion-chip" role="listitem" onclick="fillSuggestion('Call ')">Call...</button>
      <button class="suggestion-chip" role="listitem" onclick="fillSuggestion('Remind me to ')">Remind me...</button>
      <button class="suggestion-chip" role="listitem" onclick="fillSuggestion('Review ')">Review...</button>
      <button class="suggestion-chip" role="listitem" onclick="fillSuggestion('Buy ')">Buy...</button>
    </div>

    <!-- Input -->
    <div class="input-area">
      <textarea
        class="input-area__field"
        id="task-input"
        placeholder="What's on your mind?"
        rows="1"
        aria-label="Describe your task naturally"
        aria-describedby="input-hint"
        oninput="handleInput(this)"
      ></textarea>
      <button class="input-area__voice" id="voice-btn" aria-label="Speak your task" onclick="toggleVoice()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <rect x="9" y="2" width="6" height="12" rx="3"/>
          <path d="M5 10a7 7 0 0 0 14 0"/>
          <path d="M12 18v4M8 22h8"/>
        </svg>
      </button>
      <p class="input-area__hint" id="input-hint">Type naturally — "Call Sarah about the proposal by Friday 2 PM"</p>
    </div>

    <!-- Parsing indicator -->
    <div class="parsing-indicator" id="parsing-indicator" role="status" aria-label="AI is parsing your task">
      <span class="parsing-dot"></span>
      <span class="parsing-dot"></span>
      <span class="parsing-dot"></span>
      <span>AI is reading your task...</span>
    </div>

    <!-- Parsed result preview -->
    <div class="parsed-result" id="parsed-result" aria-live="polite">
      <div class="parsed-result__label">AI Parsed</div>
      <h2 class="parsed-result__title" id="parsed-title">Call Sarah about Johnson proposal</h2>

      <div class="parsed-fields">
        <!-- Deadline -->
        <div class="parsed-field">
          <div class="parsed-field__icon parsed-field__icon--deadline">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="8" cy="8" r="6"/>
              <path d="M8 5v3l2 2" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="parsed-field__info">
            <div class="parsed-field__key">Deadline</div>
            <div class="parsed-field__value" id="parsed-deadline">Friday, Feb 7 at 2:00 PM</div>
          </div>
          <button class="parsed-field__edit" aria-label="Edit deadline">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M11 2l3 3-8 8H3v-3z" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>

        <!-- Category -->
        <div class="parsed-field">
          <div class="parsed-field__icon parsed-field__icon--category">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M2 4h12M2 8h8M2 12h10" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="parsed-field__info">
            <div class="parsed-field__key">Category</div>
            <div class="parsed-field__value" id="parsed-category">Client Work</div>
          </div>
          <button class="parsed-field__edit" aria-label="Edit category">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M11 2l3 3-8 8H3v-3z" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>

        <!-- Priority -->
        <div class="parsed-field">
          <div class="parsed-field__icon parsed-field__icon--priority">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M3 14V3l6 4-6 4" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M13 3v11" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="parsed-field__info">
            <div class="parsed-field__key">Priority</div>
            <div class="parsed-field__value" id="parsed-priority">High</div>
          </div>
          <button class="parsed-field__edit" aria-label="Edit priority">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M11 2l3 3-8 8H3v-3z" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>

        <!-- Subtask -->
        <div class="parsed-field">
          <div class="parsed-field__icon parsed-field__icon--subtask">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M3 8l3 3 7-7" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="parsed-field__info">
            <div class="parsed-field__key">Subtask detected</div>
            <div class="parsed-field__value" id="parsed-subtask">Prepare proposal notes before call</div>
          </div>
          <button class="parsed-field__edit" aria-label="Edit subtask">
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M11 2l3 3-8 8H3v-3z" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Parsing reasoning (Tier 1) -->
      <div class="parsing-reasoning">
        <svg class="parsing-reasoning__icon" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="8" cy="8" r="6"/>
          <path d="M8 5v3M8 10.5v.5"/>
        </svg>
        <div class="parsing-reasoning__text">
          Detected deadline: <span class="parsing-reasoning__keyword">Friday 2 PM</span> |
          Category: <span class="parsing-reasoning__keyword">Client work</span> (keyword: proposal) |
          Priority: <span class="parsing-reasoning__keyword">High</span> (deadline + named contact)
        </div>
      </div>
    </div>

    <!-- Save / Cancel -->
    <div class="actions" id="actions">
      <button class="btn btn--secondary" aria-label="Cancel task creation">Cancel</button>
      <button class="btn btn--primary" aria-label="Save enriched task">Save Task</button>
    </div>

    <span class="sr-only" aria-live="polite" id="status-announce"></span>
  </main>

  <script>
    /* ═══════════════════════════════════════════
       SIMULATED AI PARSING
       Demonstrates the real-time parse experience
       ═══════════════════════════════════════════ */
    const input = document.getElementById('task-input');
    const parsedResult = document.getElementById('parsed-result');
    const parsingIndicator = document.getElementById('parsing-indicator');
    const actions = document.getElementById('actions');
    const hint = document.getElementById('input-hint');
    const statusAnnounce = document.getElementById('status-announce');
    let parseTimeout = null;

    function handleInput(el) {
      // Auto-resize textarea
      el.style.height = 'auto';
      el.style.height = el.scrollHeight + 'px';

      const text = el.value.trim();

      // Hide hint when typing
      hint.classList.toggle('input-area__hint--hidden', text.length > 0);

      // Show parsing indicator after brief pause
      clearTimeout(parseTimeout);
      if (text.length > 8) {
        parsedResult.classList.remove('parsed-result--visible');
        actions.classList.remove('actions--visible');
        parsingIndicator.classList.add('parsing-indicator--active');
        statusAnnounce.textContent = 'AI is parsing your task';

        parseTimeout = setTimeout(() => {
          simulateParse(text);
        }, 600);
      } else {
        parsingIndicator.classList.remove('parsing-indicator--active');
        parsedResult.classList.remove('parsed-result--visible');
        actions.classList.remove('actions--visible');
      }
    }

    function simulateParse(text) {
      // Simple keyword detection for demo
      const lowerText = text.toLowerCase();

      // Title — use first clause
      const title = text.split(/\s+by\s+|\s+at\s+|\s+before\s+|\s+tomorrow\s+|\s+today\s+/i)[0].trim();
      document.getElementById('parsed-title').textContent = title || text;

      // Deadline detection
      const deadlinePatterns = [
        { pattern: /by\s+(friday|monday|tuesday|wednesday|thursday|saturday|sunday)\s+(\d{1,2})\s*(pm|am)/i, format: (m) => `${m[1]}, Feb at ${m[2]}:00 ${m[3].toUpperCase()}` },
        { pattern: /by\s+(friday|monday|tuesday|wednesday|thursday|saturday|sunday)/i, format: (m) => `${m[1]}` },
        { pattern: /at\s+(\d{1,2})\s*(pm|am)/i, format: (m) => `Today at ${m[1]}:00 ${m[2].toUpperCase()}` },
        { pattern: /tomorrow/i, format: () => 'Tomorrow' },
        { pattern: /today/i, format: () => 'Today' },
      ];

      let deadline = 'No deadline detected';
      for (const p of deadlinePatterns) {
        const match = text.match(p.pattern);
        if (match) { deadline = p.format(match); break; }
      }
      document.getElementById('parsed-deadline').textContent = deadline;

      // Category detection
      const categories = {
        'call|phone|contact|reach out': 'Client Work',
        'buy|shop|groceries|order|purchase': 'Shopping',
        'review|read|check|audit': 'Review',
        'email|send|message|reply': 'Communication',
        'write|draft|create|design': 'Creative',
        'meet|meeting|sync|standup': 'Meetings',
        'fix|bug|debug|resolve': 'Engineering',
      };

      let category = 'General';
      for (const [keywords, cat] of Object.entries(categories)) {
        if (new RegExp(keywords, 'i').test(text)) { category = cat; break; }
      }
      document.getElementById('parsed-category').textContent = category;

      // Priority — simple heuristic
      const hasDeadline = deadline !== 'No deadline detected';
      const hasName = /[A-Z][a-z]+/.test(text);
      const hasUrgent = /urgent|asap|important|critical/i.test(text);
      let priority = 'Medium';
      if (hasUrgent || (hasDeadline && hasName)) priority = 'High';
      else if (!hasDeadline) priority = 'Low';
      document.getElementById('parsed-priority').textContent = priority;

      // Subtask detection
      const subtaskHints = {
        'call': 'Prepare notes before call',
        'review': 'Download latest version first',
        'email': 'Draft response outline',
        'buy': 'Check pantry for existing items',
        'meeting': 'Review agenda beforehand',
      };
      let subtask = 'None detected';
      for (const [hint, sub] of Object.entries(subtaskHints)) {
        if (lowerText.includes(hint)) { subtask = sub; break; }
      }
      document.getElementById('parsed-subtask').textContent = subtask;

      // Show results
      parsingIndicator.classList.remove('parsing-indicator--active');
      parsedResult.classList.add('parsed-result--visible');
      statusAnnounce.textContent = 'Task parsed successfully. Review and save.';

      // Stagger the actions button
      setTimeout(() => {
        actions.classList.add('actions--visible');
      }, 150);
    }

    function fillSuggestion(text) {
      input.value = text;
      input.focus();
      input.style.height = 'auto';
      input.style.height = input.scrollHeight + 'px';
      hint.classList.add('input-area__hint--hidden');
    }

    function toggleVoice() {
      const btn = document.getElementById('voice-btn');
      btn.classList.toggle('input-area__voice--active');
      const isActive = btn.classList.contains('input-area__voice--active');
      btn.setAttribute('aria-label', isActive ? 'Stop listening' : 'Speak your task');
      statusAnnounce.textContent = isActive ? 'Listening for voice input' : 'Voice input stopped';

      if (isActive) {
        // Simulate voice transcription
        setTimeout(() => {
          input.value = 'Call Sarah about Johnson proposal by Friday 2 PM';
          input.style.height = 'auto';
          input.style.height = input.scrollHeight + 'px';
          hint.classList.add('input-area__hint--hidden');
          btn.classList.remove('input-area__voice--active');
          btn.setAttribute('aria-label', 'Speak your task');
          handleInput(input);
        }, 2000);
      }
    }

    // Keyboard: Enter to save (not in textarea multi-line)
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        if (parsedResult.classList.contains('parsed-result--visible')) {
          statusAnnounce.textContent = 'Task saved!';
        }
      }
    });
  </script>
</body>
</html>
