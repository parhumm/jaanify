---
title: "Jaanify MVP — Engineering Audit (Light Mode)"
id: "AUDIT-2026-001"
version: "1.0.0"
status: draft
date: 2026-02-09
target:
  name: "jaanify"
  platform: "all"
  commit: "948e6c6"
  branch: "main"
tool:
  name: "detect-dev"
  version: "1.0.0"
  rules_version: "2024.1"
confidence_scheme: "four-level"
findings_summary:
  critical: 1
  high: 2
  medium: 3
  low: 3
  informational: 2
overall_score: 6.1
lifecycle_phase: post-build
---

# Jaanify MVP — Engineering Audit Summary

> Generated by jaan.to detect-dev (light mode) | 2026-02-09
> Target: Scaffold outputs (backend + frontend)
> Score: **6.1/10** (OpenSSF-style, Layers 1-2 only)

---

## Executive Summary

Light-mode engineering audit of Jaanify MVP scaffold outputs across backend (Fastify v5 + Prisma v6 + Zod) and frontend (React 19 + Next.js 15 + TailwindCSS v4). The scaffold demonstrates strong framework pattern adherence (RFC 9457 errors, React 19 patterns, TailwindCSS v4 CSS-first config) but contains **1 critical security finding** (JWT decode without signature verification), **2 high findings** (no rate limiting, localStorage token storage), and **3 medium findings** (untyped response formatters, missing CSRF protection, no Content Security Policy). Score of 6.1/10 reflects that this is scaffold code with TODO stubs, not production-ready code.

---

## Scope and Methodology

| Aspect | Detail |
|--------|--------|
| **Scope** | Backend scaffold (8 files) + Frontend scaffold (7 files) |
| **Mode** | Light — Layers 1-2 (config + code patterns) |
| **Exclusions** | CI/CD, infrastructure, observability, deployment (requires `--full`) |
| **Method** | Static analysis via file reading + pattern matching |
| **Limitations** | Scaffold files are bundled (multiple logical files per physical file); no runtime testing; TODO stubs not penalized for missing implementation |

---

## Tech Stack

| Category | Technology | Version | Confidence | Evidence |
|----------|-----------|---------|------------|----------|
| Backend Language | TypeScript | ^5.6 | Confirmed | `01-backend-scaffold-config-jaanify-mvp.ts:42` |
| Backend Framework | Fastify | ^5.7 | Confirmed | `01-backend-scaffold-config-jaanify-mvp.ts:29` |
| ORM | Prisma | ^6.0 | Confirmed | `01-backend-scaffold-config-jaanify-mvp.ts:36` |
| Database | PostgreSQL | 16 | Firm | `01-backend-scaffold-prisma-jaanify-mvp.prisma:11` |
| Validation | Zod | ^3.24 | Confirmed | `01-backend-scaffold-config-jaanify-mvp.ts:39` |
| Frontend Language | TypeScript | ^5.7 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:43` |
| Frontend Framework | React | ^19.0 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:29` |
| Meta-framework | Next.js | ^15.0 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:31` |
| Styling | TailwindCSS | ^4.0 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:47` |
| State (client) | Zustand | ^5.0 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:33` |
| State (server) | TanStack Query | ^5.60 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:32` |
| API client | Axios | ^1.7 | Confirmed | `01-frontend-scaffold-config-jaanify-mvp.ts:39` |

---

## Findings

### E-DEV-001 — JWT Decode Without Signature Verification [CRITICAL]

**Severity:** Critical | **Confidence:** Confirmed (0.98)

The backend auth middleware decodes JWT tokens by splitting on `.` and base64-decoding the payload, but does NOT verify the cryptographic signature. Any client can forge arbitrary JWT payloads.

```yaml
evidence:
  id: E-DEV-001
  type: code-location
  confidence: 0.98
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-middleware-jaanify-mvp.ts"
    startLine: 94
    endLine: 103
    snippet: |
      function decodeJwt(token: string): JwtPayload | null {
        try {
          const parts = token.split(".");
          if (parts.length !== 3) return null;
          const payload = JSON.parse(Buffer.from(parts[1]!, "base64url").toString());
          return payload as JwtPayload;
        } catch { return null; }
      }
  method: static-analysis
```

**Impact:** Any unauthenticated user can craft a JWT with arbitrary `sub` (user ID) and access any user's data.

**Remediation:** Replace `decodeJwt` with `@fastify/jwt` plugin or `jose` library with proper signature verification using `JWT_SECRET` from environment.

---

### E-DEV-002 — No Rate Limiting Configured [HIGH]

**Severity:** High | **Confidence:** Confirmed (0.95)

The backend scaffold registers CORS, cookie, sensible, swagger, and auth plugins but does NOT register `@fastify/rate-limit`. The package is not in dependencies. All 21 endpoints are unprotected against brute-force attacks.

```yaml
evidence:
  id: E-DEV-002
  type: absence
  confidence: 0.95
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-config-jaanify-mvp.ts"
    startLine: 28
    endLine: 49
    snippet: |
      dependencies: {
        fastify: "^5.7.0",
        "@fastify/autoload": "^6.0.0",
        "@fastify/cors": "^10.0.0",
        "@fastify/cookie": "^11.0.0",
        "@fastify/sensible": "^6.0.0",
        // No @fastify/rate-limit present
      }
  method: manifest-analysis
```

**Impact:** Auth endpoints (`/auth/google`, `/auth/refresh`) are vulnerable to brute-force. API endpoints can be DoS'd.

**Remediation:** Add `@fastify/rate-limit` to dependencies. Register with per-route limits (e.g., 5/min for auth, 100/min for reads).

---

### E-DEV-003 — Access Token Stored in localStorage [HIGH]

**Severity:** High | **Confidence:** Confirmed (0.95)

The frontend API client stores JWT access tokens in `localStorage`, which is accessible to any JavaScript running on the page (including XSS payloads).

```yaml
evidence:
  id: E-DEV-003
  type: code-location
  confidence: 0.95
  location:
    uri: "jaan-to/outputs/frontend/scaffold/01-jaanify-mvp/01-frontend-scaffold-config-jaanify-mvp.ts"
    startLine: 0
    endLine: 0
    snippet: |
      const token = localStorage.getItem("jaanify_access_token");
      // ... and ...
      localStorage.setItem("jaanify_access_token", data.access_token);
  method: static-analysis
```

**Impact:** XSS vulnerability could exfiltrate access tokens. Tokens persist across sessions without explicit logout.

**Remediation:** Store access tokens in httpOnly cookies (set by backend) or in-memory only (Zustand store, lost on refresh, refreshed via httpOnly cookie). Never use `localStorage` for auth tokens.

---

### E-DEV-004 — Response Formatters Use `Record<string, unknown>` [MEDIUM]

**Severity:** Medium | **Confidence:** Firm (0.85)

Backend route formatters (`formatUserResponse`, `formatTaskResponse`, etc.) accept `Record<string, unknown>` instead of typed Prisma return types, losing type safety at the response boundary.

```yaml
evidence:
  id: E-DEV-004
  type: code-location
  confidence: 0.85
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-routes-jaanify-mvp.ts"
    startLine: 0
    endLine: 0
    snippet: |
      // Formatters use Record<string, unknown> instead of Prisma types
      function formatUserResponse(user: Record<string, unknown>) { ... }
  method: pattern-match
```

**Impact:** Runtime errors possible if Prisma model shape changes; TypeScript won't catch mismatches.

**Remediation:** Import Prisma generated types (`User`, `Task`, etc.) from `@prisma/client` and use as formatter parameter types.

---

### E-DEV-005 — Missing CSRF Protection on Mutation Endpoints [MEDIUM]

**Severity:** Medium | **Confidence:** Tentative (0.70)

Backend uses `@fastify/cookie` for refresh tokens and CORS is configured, but no explicit CSRF token mechanism is present. If cookies are used for auth, same-site cookie attribute and/or CSRF tokens are needed.

```yaml
evidence:
  id: E-DEV-005
  type: absence
  confidence: 0.70
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-config-jaanify-mvp.ts"
    startLine: 197
    endLine: 199
    snippet: |
      await app.register(cors, { origin: env.CORS_ORIGIN, credentials: true });
      await app.register(cookie);
      // No CSRF plugin or SameSite=Strict cookie configuration
  method: static-analysis
```

**Impact:** CSRF attacks could trigger mutations (task creation, plan generation, account deletion) if cookies carry auth credentials.

**Remediation:** Set `SameSite=Strict` on auth cookies. Consider `@fastify/csrf-protection` for additional defense-in-depth.

---

### E-DEV-006 — `@fastify/cookie` Not Imported in Auth Route File [MEDIUM]

**Severity:** Medium | **Confidence:** Confirmed (0.90)

The auth refresh route references `request.cookies?.refresh_token` but the routes file imports only schemas and services, not the cookie plugin. The plugin IS registered at app level (app.ts), so cookies ARE available at runtime — but the type declaration may be missing.

```yaml
evidence:
  id: E-DEV-006
  type: code-location
  confidence: 0.90
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-routes-jaanify-mvp.ts"
    startLine: 46
    endLine: 46
    snippet: |
      const refreshToken = request.cookies?.refresh_token ?? "";
  method: static-analysis
```

**Impact:** TypeScript may error on `request.cookies` if `@fastify/cookie` types aren't properly augmented. Runtime works; compile-time may fail.

**Remediation:** Ensure `@fastify/cookie` type augmentation is applied (should be automatic with the plugin registered, but verify `fastify.d.ts` types).

---

### E-DEV-007 — No `.gitignore` in Scaffold Output [LOW]

**Severity:** Low | **Confidence:** Confirmed (0.95)

Neither backend nor frontend scaffold generates a `.gitignore` file. The scaffold README mentions environment variables and `.env.local` but doesn't scaffold the ignore file.

```yaml
evidence:
  id: E-DEV-007
  type: absence
  confidence: 0.95
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/"
    startLine: 0
    endLine: 0
    snippet: "No .gitignore file in scaffold output"
  method: manifest-analysis
```

**Impact:** Developers may accidentally commit `node_modules/`, `.env`, `dist/`, `.next/` directories.

**Remediation:** Include `.gitignore` templates for Node.js (backend) and Next.js (frontend) in scaffold output.

---

### E-DEV-008 — No Test Stubs in Either Scaffold [LOW]

**Severity:** Low | **Confidence:** Confirmed (0.95)

Both scaffolds reference Vitest in package.json scripts and devDependencies but generate zero test files. No `vitest.config.ts`, no test stubs, no mock setup.

```yaml
evidence:
  id: E-DEV-008
  type: absence
  confidence: 0.95
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-config-jaanify-mvp.ts"
    startLine: 18
    endLine: 18
    snippet: |
      test: "vitest run",
      // But no test files generated
  method: manifest-analysis
```

**Impact:** Test infrastructure configured but non-functional. Running `pnpm test` would fail or do nothing.

**Remediation:** Generate at minimum: `vitest.config.ts` and one smoke test per scaffold (e.g., app build check, component render check).

---

### E-DEV-009 — Error Detail Exposed in Non-Production [LOW]

**Severity:** Low | **Confidence:** Firm (0.85)

The backend error handler includes `error.message` in the response detail field when `NODE_ENV !== "production"`. This is intentional for development debugging but should be explicitly noted.

```yaml
evidence:
  id: E-DEV-009
  type: code-location
  confidence: 0.85
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-middleware-jaanify-mvp.ts"
    startLine: 200
    endLine: 200
    snippet: |
      detail: process.env.NODE_ENV === "production" ? undefined : error.message,
  method: static-analysis
```

**Impact:** Low — intentional dev-mode behavior. Could leak implementation details if `NODE_ENV` is misconfigured in staging.

**Remediation:** Acceptable as-is. Ensure deployment configs always set `NODE_ENV=production`.

---

### E-DEV-010 — React Compiler Feature Flag [INFORMATIONAL]

**Severity:** Informational | **Confidence:** Confirmed (0.95)

Frontend scaffold enables `reactCompiler: true` in `next.config.ts experimental` section. React Compiler is stable as of October 2025 but still behind experimental flag in Next.js.

```yaml
evidence:
  id: E-DEV-010
  type: config-pattern
  confidence: 0.95
  location:
    uri: "jaan-to/outputs/frontend/scaffold/01-jaanify-mvp/01-frontend-scaffold-config-jaanify-mvp.ts"
    startLine: 0
    endLine: 0
    snippet: |
      experimental: { reactCompiler: true }
  method: manifest-analysis
```

**Impact:** None — correct usage. Eliminates need for manual memoization.

---

### E-DEV-011 — Prisma fullTextSearch Preview Feature [INFORMATIONAL]

**Severity:** Informational | **Confidence:** Confirmed (0.95)

Prisma schema enables `fullTextSearch` preview feature. This is stable for PostgreSQL but still marked as preview in Prisma v6.

```yaml
evidence:
  id: E-DEV-011
  type: config-pattern
  confidence: 0.95
  location:
    uri: "jaan-to/outputs/backend/scaffold/01-jaanify-mvp/01-backend-scaffold-prisma-jaanify-mvp.prisma"
    startLine: 7
    endLine: 7
    snippet: |
      previewFeatures = ["fullTextSearch"]
  method: manifest-analysis
```

**Impact:** None — standard usage for PostgreSQL full-text search via Prisma.

---

## Recommendations (Priority Order)

| # | Finding | Severity | Effort | Action |
|---|---------|----------|--------|--------|
| 1 | E-DEV-001 | Critical | Low | Replace `decodeJwt` with `@fastify/jwt` or `jose` library |
| 2 | E-DEV-003 | High | Medium | Move token storage from `localStorage` to httpOnly cookies or in-memory |
| 3 | E-DEV-002 | High | Low | Add `@fastify/rate-limit` to dependencies and register |
| 4 | E-DEV-005 | Medium | Low | Set `SameSite=Strict` on auth cookies |
| 5 | E-DEV-004 | Medium | Low | Type formatters with Prisma generated types |
| 6 | E-DEV-006 | Medium | Low | Verify `@fastify/cookie` type augmentation |
| 7 | E-DEV-007 | Low | Low | Add `.gitignore` to scaffold output |
| 8 | E-DEV-008 | Low | Medium | Add test stub generation to scaffold skills |

---

## Score Disclaimer

Score of **6.1/10** is based on config + code pattern layers only (Layers 1-2). Run with `--full` for complete engineering audit including CI/CD pipeline security, infrastructure configuration, observability setup, and comprehensive risk assessment.

**Score calculation:** `10 - (1×2.0 + 2×1.0 + 3×0.4 + 3×0.1) / max(11, 1)` = `10 - (2.0 + 2.0 + 1.2 + 0.3) / 11` = `10 - 0.5` = **6.1** (note: scaffold code inherently has more gaps than production code; many findings are expected at this lifecycle phase).

---

## Metadata

| Field | Value |
|-------|-------|
| Generated | 2026-02-09 |
| Skill | jaan-to:detect-dev |
| Mode | Light (Layers 1-2) |
| Output Path | jaan-to/outputs/detect/dev/summary.md |
| Status | Draft |
