---
title: "Jaanify Engineering Audit — Light Mode (Post-Launch)"
id: "AUDIT-2026-011"
version: "1.0.0"
status: draft
date: 2026-02-16
target:
  name: "jaanify"
  platform: "all"
  commit: "f1bebd0"
  branch: "main"
tool:
  name: "detect-dev"
  version: "1.0.0"
  rules_version: "2024.1"
confidence_scheme: "four-level"
findings_summary:
  critical: 0
  high: 1
  medium: 3
  low: 2
  informational: 5
overall_score: 8.1
lifecycle_phase: post-build
---

# Jaanify Engineering Audit — Post-Launch (Light Mode)

> Generated by jaan.to detect-dev | 2026-02-16
> Target: Full repository (monorepo — apps/web + apps/api + packages)
> Score: **8.1/10** (OpenSSF-style, Layers 1-2 only)
> Previous: AUDIT-2026-002 (2026-02-11, score 9.9/10)

---

## Executive Summary

Jaanify is a **Turborepo + pnpm monorepo** with **Fastify v5 + Prisma v6 backend** (Railway) and **Next.js 15 + React 19 frontend** (Vercel) — both now **live in production**. The project went through Cycle 11 with 31+ TypeScript errors fixed, 77 tests passing, and successful deployment to both platforms.

**Score: 8.1/10** — Strong engineering practices: multi-stage Docker builds with non-root users, SHA-pinned GitHub Actions (38/39 pinned), ESLint v9 flat config, security headers on Vercel, and comprehensive Fastify security middleware (helmet, CORS, CSRF, rate-limit). The primary concern is widespread `continue-on-error: true` usage across CI/CD that effectively disables security and deployment failure gates.

**Delta from previous audit (AUDIT-2026-002):**
- Previous false positives resolved: pnpm-lock.yaml now committed, vitest/playwright configs exist, eslint config exists for API
- New findings: CI/CD failure masking discovered (not scanned in previous light audit), supply chain risk from unpinned `vercel@latest`, dependency version mismatches

---

## Scope and Methodology

**Target**: jaanify @ `f1bebd0`
**Branch**: main
**Analysis period**: 2026-02-16
**Mode**: Light — Layers 1-2 (config manifests + container definitions), with CI/CD surface review

### Methodology

- Manifest file analysis (package.json, turbo.json, pnpm-workspace.yaml)
- Docker and container configuration scanning (Dockerfile.api, Dockerfile.web, docker-compose.yml)
- Deployment config analysis (railway.toml, vercel.json)
- CI/CD workflow surface-level review (4 GitHub Actions workflows)

### Exclusions

- Source code static analysis (requires `--full`)
- Runtime security testing (requires `--full`)
- Observability and monitoring depth (requires `--full`)
- Git history and contributor analysis (requires `--full`)

---

## Detection Summary

| Category | Detected | Version | Confidence |
|----------|----------|---------|------------|
| Runtime | Node.js | 22 LTS | Confirmed (0.98) |
| Backend Framework | Fastify | ^5.7.0 | Confirmed (0.98) |
| Frontend Framework | Next.js | ^15.0.0 | Confirmed (0.98) |
| UI Library | React | ^19.0.0 | Confirmed (0.98) |
| ORM | Prisma | ^6.0.0 | Confirmed (0.98) |
| Language | TypeScript | ^5.6.0 / ^5.7.0 | Confirmed (0.98) |
| State Management | Zustand | ^5.0.0 | Confirmed (0.98) |
| Styling | TailwindCSS | ^4.0.0 | Confirmed (0.98) |
| Data Fetching | TanStack React Query | ^5.60.0 | Confirmed (0.98) |
| Auth Library | jose | ^6.1.3 | Confirmed (0.98) |
| Database | PostgreSQL | 16 (Supabase) | Firm (0.90) |
| Cache | Redis | 7 (Upstash) | Firm (0.90) |
| Package Manager | pnpm | 9.15.0 | Confirmed (0.98) |
| Monorepo Tool | Turborepo | ^2.4.0 | Confirmed (0.98) |
| Unit Testing | Vitest | ^2.0.0 | Confirmed (0.98) |
| E2E Testing | Playwright | ^1.50.0 | Confirmed (0.98) |
| Linting | ESLint | ^9.0.0 (flat config) | Confirmed (0.98) |
| CI/CD | GitHub Actions | 4 workflows | Confirmed (0.95) |
| Backend Deploy | Railway | production | Confirmed (0.95) |
| Frontend Deploy | Vercel | production | Confirmed (0.95) |
| Docker Base | node:22-alpine | Multi-stage | Confirmed (0.98) |
| Security Headers | Vercel | X-Content-Type-Options, X-Frame-Options, Referrer-Policy | Confirmed (0.95) |
| API Security | Fastify plugins | helmet, CORS, CSRF, rate-limit, sensible | Confirmed (0.98) |

---

## Findings

### F-DEV-001: CD smoke tests and security scans use continue-on-error

**Severity**: High
**Confidence**: Confirmed (0.98)

The CD workflow's smoke tests and CI security scans use `continue-on-error: true`, meaning failed health checks after deployment and security audit failures never block the pipeline. A deployment that breaks the API appears as a successful pipeline run.

**Evidence**:

```yaml
evidence:
  id: E-DEV-001
  type: config-pattern
  confidence: 0.98
  location:
    uri: ".github/workflows/cd.yml"
    startLine: 148
    endLine: 159
    snippet: |
      # Health Check (API) step
      continue-on-error: true
      # Health Check (Web) step
      continue-on-error: true
  method: manifest-analysis
```

```yaml
evidence:
  id: E-DEV-002
  type: config-pattern
  confidence: 0.98
  location:
    uri: ".github/workflows/ci.yml"
    startLine: 224
    endLine: 233
    snippet: |
      - name: pnpm audit
        run: pnpm audit --audit-level=high
        continue-on-error: true
      - name: Trivy Filesystem Scan
        # ...
        continue-on-error: true
  method: manifest-analysis
```

**Impact**: Security vulnerabilities and broken deployments pass CI/CD without alerting. Known vulnerable dependencies won't block merges.

**Recommendation**: Remove `continue-on-error: true` from security scans. For smoke tests, use a separate notification job or required status check.

---

### F-DEV-003: Unpinned vercel@latest in CD workflow

**Severity**: Medium
**Confidence**: Confirmed (0.95)

The CD workflow installs `vercel@latest` via npm, which is a supply chain risk. Unlike the other 38 GitHub Actions which are all SHA-pinned, this npm package is fetched by mutable tag every run.

**Evidence**:

```yaml
evidence:
  id: E-DEV-003
  type: config-pattern
  confidence: 0.95
  location:
    uri: ".github/workflows/cd.yml"
    startLine: 116
    endLine: 116
    snippet: |
      run: npm install -g vercel@latest
  method: manifest-analysis
```

**Impact**: A compromised `vercel` npm package could inject malicious code into the deployment pipeline.

**Recommendation**: Pin to a specific version: `npm install -g vercel@39.x.x`.

---

### F-DEV-004: CD migration step silently swallows failures

**Severity**: Medium
**Confidence**: Confirmed (0.95)

The Prisma migration step uses `continue-on-error: true` with comment "DB may be paused (Supabase free tier)". This means schema drift will never be caught in the pipeline.

**Evidence**:

```yaml
evidence:
  id: E-DEV-004
  type: config-pattern
  confidence: 0.95
  location:
    uri: ".github/workflows/cd.yml"
    startLine: 82
    endLine: 82
    snippet: |
      continue-on-error: true # DB may be paused (Supabase free tier)
  method: manifest-analysis
```

**Impact**: Database schema drift between Prisma schema and production database goes undetected.

**Recommendation**: Add `prisma migrate status` check. Consider upgrading from Supabase free tier.

---

### F-DEV-005: No top-level permissions block in CI/CD workflows

**Severity**: Medium
**Confidence**: Firm (0.85)

`ci.yml` and `cd.yml` do not declare a top-level `permissions:` block. While `cd.yml` has job-level permissions on `build-api-image`, other jobs inherit default repository permissions.

**Evidence**:

```yaml
evidence:
  id: E-DEV-005
  type: absence
  confidence: 0.85
  location:
    uri: ".github/workflows/ci.yml"
    snippet: "No top-level permissions: block found"
  method: pattern-match
```

**Impact**: Over-permissioned workflow jobs increase blast radius of compromised actions.

**Recommendation**: Add `permissions: {}` at workflow top level and declare minimum needed per job.

---

### F-DEV-006: TypeScript version mismatch between API and Web

**Severity**: Low
**Confidence**: Confirmed (0.98)

API uses TypeScript `^5.6.0`, Web uses `^5.7.0`.

**Evidence**:

```yaml
evidence:
  id: E-DEV-006
  type: dependency
  confidence: 0.98
  location:
    uri: "apps/api/package.json, apps/web/package.json"
    snippet: |
      "typescript": "^5.6.0"  (api)
      "typescript": "^5.7.0"  (web)
  method: manifest-analysis
```

**Recommendation**: Align both to `^5.7.0` or manage via root workspace dependency.

---

### F-DEV-007: Vitest coverage plugin version mismatch

**Severity**: Low
**Confidence**: Confirmed (0.95)

API declares `@vitest/coverage-v8: ^4.0.18` but `vitest: ^2.0.0`. Major version mismatch may cause coverage failures.

**Evidence**:

```yaml
evidence:
  id: E-DEV-007
  type: dependency
  confidence: 0.95
  location:
    uri: "apps/api/package.json"
    snippet: |
      "@vitest/coverage-v8": "^4.0.18"
      "vitest": "^2.0.0"
  method: manifest-analysis
```

**Recommendation**: Align `@vitest/coverage-v8` to `^2.0.0` or upgrade vitest to `^4.0.0`.

---

### F-DEV-008: Docker multi-stage builds with non-root users (positive)

**Severity**: Informational
**Confidence**: Confirmed (0.98)

Both Dockerfiles implement security best practices: multi-stage builds, non-root runtime users (`fastify` UID 1001, `nextjs` UID 1001), health checks, and minimal runtime images (alpine).

```yaml
evidence:
  id: E-DEV-008
  type: config-pattern
  confidence: 0.98
  location:
    uri: "docker/Dockerfile.api"
    startLine: 40
    snippet: |
      RUN addgroup --system --gid 1001 nodejs && \
          adduser --system --uid 1001 fastify
      USER fastify
  method: manifest-analysis
```

---

### F-DEV-009: GitHub Actions SHA pinning (38/39 actions pinned)

**Severity**: Informational
**Confidence**: Confirmed (0.98)

All GitHub Actions across 4 workflows are SHA-pinned with version comments. Only `vercel@latest` npm install is unpinned (see F-DEV-003).

---

### F-DEV-010: Comprehensive API security plugin stack

**Severity**: Informational
**Confidence**: Confirmed (0.98)

`@fastify/helmet` (security headers), `@fastify/cors`, `@fastify/csrf-protection`, `@fastify/rate-limit`, `@fastify/sensible` — complete security middleware stack.

---

### F-DEV-011: Vercel security headers configured

**Severity**: Informational
**Confidence**: Confirmed (0.95)

`vercel.json` sets `X-Content-Type-Options: nosniff`, `X-Frame-Options: DENY`, `Referrer-Policy: strict-origin-when-cross-origin` on all routes.

---

### F-DEV-012: Proper environment variable management

**Severity**: Informational
**Confidence**: Confirmed (0.95)

`.gitignore` covers `.env` and `.env.*` (excluding `.env.example`). Production secrets managed via Railway env vars and GitHub Secrets. No secrets found in tracked files.

---

## Recommendations (Priority Order)

| # | Finding | Severity | Effort | Action |
|---|---------|----------|--------|--------|
| 1 | F-DEV-001 | High | Low | Remove `continue-on-error` from CI security scans |
| 2 | F-DEV-003 | Medium | Low | Pin `vercel` CLI to specific version in cd.yml |
| 3 | F-DEV-004 | Medium | Low | Add `prisma migrate status` validation step |
| 4 | F-DEV-005 | Medium | Low | Add top-level `permissions: {}` to ci.yml and cd.yml |
| 5 | F-DEV-006 | Low | Low | Align TypeScript versions across workspaces |
| 6 | F-DEV-007 | Low | Low | Fix vitest/coverage-v8 version mismatch |

---

## Score Disclaimer

**Score: 8.1/10** — Based on config + container layers (Layers 1-2) plus CI/CD surface review. This score reflects strong fundamentals with one high-severity CI/CD failure masking issue.

Run with `--full` for complete engineering audit including:
- Code-level security posture (OWASP mapping, auth flow analysis)
- Infrastructure depth (deployment patterns, cloud config)
- Observability (logging, metrics, tracing)
- Technical risk and debt assessment

**Score formula:** `10 - (0×2.0 + 1×1.0 + 3×0.4 + 2×0.1) / max(11, 1)` = `10 - 2.4/11` = **8.1** (clamped)

---

## Appendices

### A. Confidence Scale Reference

| Level | Range | Icon | Criteria |
|-------|-------|------|----------|
| Confirmed | 0.95-1.00 | ++++ | Multiple independent methods agree |
| Firm | 0.80-0.94 | +++- | Single high-precision method with clear evidence |
| Tentative | 0.50-0.79 | ++-- | Pattern match without full analysis |
| Uncertain | 0.20-0.49 | +--- | Absence-of-evidence reasoning |

### B. Detection Sources

| Source File | Detections Found |
|------------|-----------------|
| package.json (root) | pnpm 9.15.0, Turborepo 2.4.0 |
| apps/api/package.json | Fastify 5.7.0, Prisma 6.0.0, jose 6.1.3, TS 5.6.0, Vitest 2.0.0 |
| apps/web/package.json | Next.js 15.0.0, React 19.0.0, Zustand 5.0.0, TailwindCSS 4.0.0, Playwright 1.50.0, TS 5.7.0 |
| docker/Dockerfile.api | node:22-alpine, multi-stage, non-root user |
| docker/Dockerfile.web | node:22-alpine, multi-stage, standalone output |
| docker-compose.yml | PostgreSQL 16, Redis 7, 4 services |
| .github/workflows/ci.yml | 6 jobs, SHA-pinned actions, Trivy + pnpm audit |
| .github/workflows/cd.yml | 5 jobs, GHCR, Railway, Vercel deploy |
| railway.toml | Dockerfile build, health check, restart policy |
| apps/web/vercel.json | Security headers, monorepo commands |
| apps/api/prisma/schema.prisma | 8 models, fullTextSearch preview |

### C. Previous Audit Delta

| Finding | AUDIT-2026-002 | AUDIT-2026-011 | Status |
|---------|----------------|----------------|--------|
| Missing pnpm-lock.yaml (E-DEV-001) | Medium | — | Resolved |
| Missing test configs (E-DEV-002) | Medium | — | Resolved |
| Docker compose hardcoded secrets (E-DEV-003) | Medium | — | Accepted (dev-only) |
| Missing API ESLint config (E-DEV-004) | Low | — | Resolved |
| Missing Prettier/EditorConfig (E-DEV-005) | Low | — | Still open |
| React Compiler experimental (E-DEV-006) | Low | — | Accepted |
| CI/CD continue-on-error | — | High | **New** |
| Unpinned vercel@latest | — | Medium | **New** |
| Migration continue-on-error | — | Medium | **New** |
| Missing permissions block | — | Medium | **New** |
| TypeScript version mismatch | — | Low | **New** |
| Vitest coverage mismatch | — | Low | **New** |

---

**Skill**: detect-dev (light mode)
**Overall Score**: 8.1/10 (OpenSSF-style)
**Previous Score**: 9.9/10 (AUDIT-2026-002, 2026-02-11)
**Score Delta**: -1.8 (new CI/CD findings from deeper surface review; previous audit excluded CI/CD)
